webpackJsonp([43],{VFlC:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("aA9S"),r=a.n(i),n=a("lC5x"),s=a.n(n),o=a("J0Oq"),c=a.n(o),d=a("gyMJ"),p={data:function(){return{radio:"0",LOADING:!0,info:{recipientsOwedVOS:[]},type:0,obj:"",owedPeriods:"",continueStatus:!1,tipStatus:!1,radioHelp:"3",icon:{active:a("YJdq"),normal:a("OSO4")},checkedArr:[],totalPeriods:1,loveValue:1,recipientsOwedPayDTOS:[],arrears:0}},mounted:function(){this.$toast.loading({duration:0,forbidClick:!0,mask:!0,message:"加载中..."}),this.obj=this.$route.query.info,this.type=this.$route.query.typeHelp,this.payInfo(this.obj,this.type)},methods:{payInfo:function(e,t){var a=this;return c()(s.a.mark(function i(){var r,n;return s.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,d.a.payInfo({paymentId:e,type:t});case 2:200===(r=i.sent).code&&(a.$toast.clear(),a.info=r.data,0===r.data.recipientsOwedVOS.length?a.continueStatus=!1:a.continueStatus=!0,(n=r.data.recipientsOwedVOS.filter(function(e){return e.owedPeriods>0})).forEach(function(e){a.checkedArr.push(e.recipientsId),a.arrears+=e.arrears}),a.recipientsOwedPayDTOS=n);case 4:case"end":return i.stop()}},i,a)}))()},wxPay:function(){var e=this.info,t={helpType:this.type,payType:this.radio,planId:e.planId,paymentId:e.paymentId};"4"===this.radioHelp?(t.amount="0"==this.radio?e.amount/1e4+this.arrears/1e4:e.oneTimePayment/1e4+this.arrears/1e4,t.recipientsOwedPayDTOS=this.recipientsOwedPayDTOS):(t.amount="0"==this.radio?e.amount/1e4:e.oneTimePayment/1e4,t.recipientsOwedPayDTOS=[]),this.WxPay(t)},WxPay:function(e){var t=this;return c()(s.a.mark(function a(){var i,n;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,d.a.WxPay(e);case 2:200===(i=a.sent).code?(n=r()({},i.data,{package:i.data.packageValue}),t.wxpay(n)):706===i.code?t.$dialog.alert({message:i.message}).then(function(){t.$router.push({path:"/helpProgram"})}):t.$dialog({message:i.message});case 4:case"end":return a.stop()}},a,t)}))()},wxpay:function(e){var t=this;return c()(s.a.mark(function a(){var i;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:i=t,WeixinJSBridge.invoke("getBrandWCPayRequest",e,function(e){"get_brand_wcpay_request:ok"==e.err_msg?i.$router.replace({path:"/helpProgram/groupBuyerSuccess",query:{type:i.type,planId:i.info.planId}}):e.err_msg});case 2:case"end":return a.stop()}},a,t)}))()},itemList:function(e){if(e.target.checked)this.recipientsOwedPayDTOS.push({arrears:e.target.dataset.arrears,owedPeriods:e.target.dataset.owedperiods,recipientsId:e.target.dataset.recipientsid});else{var t=this.recipientsOwedPayDTOS.filter(function(t){return t.recipientsId!=e.target.dataset.recipientsid});this.recipientsOwedPayDTOS=t}var a=this.recipientsOwedPayDTOS.reduce(function(e,t){return e+parseFloat(t.arrears)},0);this.arrears=a},closeTip:function(){this.tipStatus=!1},openTip:function(){this.tipStatus=!0}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-index"},[a("div",{staticClass:"page_title"},[a("p",[e._v(e._s(e.info.title))]),e._v(" "),a("div",[a("p",[e._v("帮扶对象:")]),e._v(" "),a("div",[a("div",e._l(e.info.recipientsSimpleInfoVOS,function(e,t){return a("img",{key:t,style:{backgroundImage:"url("+e.photo+")",backgroundSize:"cover"}})}),0)])])]),e._v(" "),a("div",{staticClass:"details_n"},[e._m(0),e._v(" "),a("p",[a("span",[e._v("资助人数:")]),e._v(" "),a("span",[e._v(e._s(e.info.recipientsCount)+"人")])]),e._v(" "),a("div",{staticClass:"repicientInfoNum"},e._l(e.info.recipientsSimpleInfoVOS,function(t,i){return a("p",{key:i},[a("span",[e._v(e._s(t.name))]),e._v(" "),a("span",[a("van-rate",{attrs:{count:t.totalPeriods,icon:"like","void-icon":"like-o",size:20,color:"red","void-color":"red",readonly:""},model:{value:t.loveValue,callback:function(a){e.$set(t,"loveValue",a)},expression:"item.loveValue"}})],1)])}),0)]),e._v(" "),a("div",{staticClass:"buyer_content"},[a("div",[a("h2",[e._v("选择缴费方式")]),e._v(" "),a("van-radio-group",{model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[a("van-radio",{attrs:{name:"0","checked-color":"#40d0ad"}},[e._v("按年缴费")]),e._v(" "),a("van-radio",{attrs:{name:"1","checked-color":"#40d0ad"}},[e._v("一次性缴费")])],1)],1)]),e._v(" "),a("van-cell",{attrs:{title:"资助金额（元）",value:"0"==e.radio?100*e.info.recipientsCount+"元":e.info.oneTimePayment+"元"}}),e._v(" "),e.continueStatus?a("div",{staticClass:"continue buyer_content"},[a("div",{staticClass:"stop"},[a("h2",[e._v("教育互助延续")]),e._v(" "),a("span",{on:{click:e.openTip}},[e._v("\n        共"+e._s(e.info.recipientsOwedVOS.length)+"人\n        "),a("van-icon",{attrs:{name:"question-o"}})],1)]),e._v(" "),a("van-radio-group",{model:{value:e.radioHelp,callback:function(t){e.radioHelp=t},expression:"radioHelp"}},[a("van-radio",{attrs:{name:"3","checked-color":"#40d0ad"}},[e._v("否")]),e._v(" "),a("van-radio",{attrs:{name:"4","checked-color":"#40d0ad"}},[e._v("是")])],1),e._v(" "),"4"===e.radioHelp?a("ul",e._l(e.info.recipientsOwedVOS,function(t,i){return a("li",{key:i},[a("div",{staticClass:"topInfo"},[a("span",{staticClass:"selected_status",on:{change:e.itemList}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.checkedArr,expression:"checkedArr"}],attrs:{type:"checkbox","data-owedPeriods":t.owedPeriods,"data-recipientsId":t.recipientsId,"data-arrears":t.arrears,"data-index":i},domProps:{value:t.recipientsId,checked:Array.isArray(e.checkedArr)?e._i(e.checkedArr,t.recipientsId)>-1:e.checkedArr},on:{change:function(a){var i=e.checkedArr,r=a.target,n=!!r.checked;if(Array.isArray(i)){var s=t.recipientsId,o=e._i(i,s);r.checked?o<0&&(e.checkedArr=i.concat([s])):o>-1&&(e.checkedArr=i.slice(0,o).concat(i.slice(o+1)))}else e.checkedArr=n}}}),e._v(" "),a("img",{attrs:{src:e.checkedArr.indexOf(t.recipientsId)>=0?e.icon.active:e.icon.normal,alt:""}})]),e._v(" "),a("div",{staticClass:"info"},[a("p",[a("span",[e._v(e._s(t.name))]),e._v(" "),a("span",[e._v("\n                需要帮扶延续:\n                "),a("van-rate",{attrs:{count:t.owedPeriods,icon:"like","void-icon":"like-o",size:20,color:"red","void-color":"red",readonly:""},model:{value:t.owedPeriods,callback:function(a){e.$set(t,"owedPeriods",a)},expression:"item.owedPeriods"}})],1),e._v(" "),a("span",[e._v("￥"+e._s(t.arrears))])])])])])}),0):e._e(),e._v(" "),"4"===e.radioHelp?a("van-cell",{staticClass:"continueMoney",attrs:{title:"资助金额（元）",value:e.arrears+"元"}}):e._e()],1):e._e(),e._v(" "),a("div",{staticClass:"buyer_footer",on:{click:e.wxPay}},[a("van-button",{attrs:{type:"primary"}},[e._v("支付")])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.tipStatus,expression:"tipStatus"}],staticClass:"tip"},[a("div",[a("div",[a("van-icon",{attrs:{name:"cross"},on:{click:e.closeTip}})],1),e._v(" "),e._m(1)])])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("span",[this._v("资助详情:")]),this._v(" "),t("span",[this._v("每人100元/年")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",[a("span",[e._v("敬爱的爱心人士您好")]),e._v(" "),a("span",[e._v("教育帮扶延续是因为您帮扶")]),e._v(" "),a("span",[e._v("的小孩中因中途被暂停帮扶导致")]),e._v(" "),a("span",[e._v("不能获得完整的奖励金")]),e._v(" "),a("span",[e._v("为了孩子能够获得更多助学奖励")])])}]};var u=a("C7Lr")(p,l,!1,function(e){a("fvai")},"data-v-2b3d9fd2",null);t.default=u.exports},fvai:function(e,t){}});