webpackJsonp([13],{"6Ggo":function(t,e){},"9jY9":function(t,e,a){"use strict";var i,s=a("xd7I");i=!1,s.a.directive("intervalclick",function(t,e){t.onclick=function(t){if(!i)if(i=!i,e.value){var a=e.value.func,s=e.value.time;if("number"==typeof s){var r=[];for(var n in e.value)if(e.value.hasOwnProperty(n)){if("func"===n||"time"===n)continue;r.push(e.value[n])}setTimeout(function(){i=!i},s),a.apply(void 0,r)}else alert("传入等待时间错误")}else alert("未传入Value数据！")}})},T2ZH:function(t,e){},UpfW:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("aA9S"),s=a.n(i),r=a("lC5x"),n=a.n(r),o=a("J0Oq"),c=a.n(o),l=a("pa6O"),u=a("gyMJ"),d=a("w3CS"),p=a("telf"),v=a("cfGD"),m=a("YvwL"),f=a("bjyp"),g=a("cnSu"),h=(a("9jY9"),{data:function(){return{selectGrade:!1,areaStatus:!1,deteleStatus:!1,photo:"",positivePic:"",againstPic:"",learnPic:"",familyPic:"",recipientsId:"",item:{name:"",cardId:"",age:"",sex:"请选择性别",sexName:"根据身份证识性别",classNumber:"",region:"请选择地址",address:"",photo:"",family:"",learn:"",grade:"",photos:[{type:1,urls:[]},{type:2,urls:[]},{type:3,urls:[]}]},areaList:p.a}},components:{gradeName:l.a},mixins:[v.a,m.a,f.a,g.a],mounted:function(){var t=this.$route.query.recipientsId;this.recipientsId=t,void 0!=t&&(this.RecipientsInfo(t),this.photoStatus=!0,this.positivePicState=!0,this.againstPicState=!0,this.familyStatus=!0,this.learnStatus=!0)},methods:{RecipientsInfo:function(t){var e=this;return c()(n.a.mark(function a(){var i,s,r;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,u.a.RecipientsInfo(t);case 2:200===(i=a.sent).code?(e.item=i.data,e.item.sexName=1===i.data.sex?"男":"女",e.positivePic=i.data.photos.filter(function(t){return 1==t.type})[0].urls[0],e.againstPic=i.data.photos.filter(function(t){return 1==t.type})[0].urls[1],0==(s=i.data.photos.filter(function(t){return 3==t.type})).length?(e.stydyPicMore=[],e.studyPic=[],e.item.photos.push({type:3,urls:[]})):(e.studyPic=s[0].urls,e.stydyPicMore=s[0].urls),0==(r=i.data.photos.filter(function(t){return 2==t.type})).length?(e.familyPicMore=[],e.morePic=[],e.item.photos.push({type:2,urls:[]})):(e.morePic=r[0].urls,e.familyPicMore=r[0].urls)):e.$dialog.alert({message:i.message});case 4:case"end":return a.stop()}},a,e)}))()},deleteList:function(){var t=this,e=this.$route.query.projectId,a=this.$route.query.status;this.$dialog.alert({message:"确定要删除该受助人吗？"}).then(function(i){u.a.delRecipients(t.recipientsId).then(function(i){200===i.code?void 0==a?t.$router.push({path:"/helpProgram/groupResets",query:{active:2}}):t.$router.push({path:"/helpProgram/groupResets",query:{status:a,projectId:e,active:2}}):t.$dialog.alert({message:i.message})})}).catch(function(){})},updataClick:function(){this.validator()},dataClick:function(){this.validator()},validator:function(){var t=this;return c()(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(t.item),""!==t.item.photo){e.next=4;break}return t.$toast("请上传头像"),e.abrupt("return",!1);case 4:if(Object(d.c)(t.item.name)){e.next=7;break}return t.$toast("请填写真实姓名"),e.abrupt("return",!1);case 7:if(!(t.item.age<6||t.item.age>18)){e.next=10;break}return t.$toast("年龄不在合理范围内"),e.abrupt("return",!1);case 10:if("男"==t.item.sexName?t.item.sex=1:"女"==t.item.sexName&&(t.item.sex=2),""!==t.item.classNumber){e.next=14;break}return t.$toast("请选择年级"),e.abrupt("return",!1);case 14:if("请选择地址"!==t.item.region){e.next=17;break}return t.$toast("请正确填写地址"),e.abrupt("return",!1);case 17:if(""!==t.item.address){e.next=20;break}return t.$toast("请正确填写详细地址"),e.abrupt("return",!1);case 20:if(!(t.item.photos[0].urls.length<2||null==t.item.photos[0].urls[0]||null==t.item.photos[0].urls[1])){e.next=23;break}return t.$toast("请上传身份证图片"),e.abrupt("return",!1);case 23:void 0!=t.recipientsId&&(t.item=s()({},t.item,{recipientsId:t.recipientsId})),t.saveRecipients(t.item);case 25:case"end":return e.stop()}},e,t)}))()},saveRecipients:function(t){var e=this;return c()(n.a.mark(function a(){var i,r,o,c;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i=e.$route.query.projectId,r=e.$route.query.status,o=s()({},t,{projectId:i}),a.next=5,u.a.saveRecipients(o);case 5:200===(c=a.sent).code?void 0==r?e.$router.push({path:"/helpProgram/groupResets",query:{active:2}}):e.$router.push({path:"/helpProgram/groupResets",query:{status:r,projectId:i,active:2}}):e.$dialog.alert({message:c.message});case 7:case"end":return a.stop()}},a,e)}))()},deletePic:function(t){this.DeletePic(t)},fileClick:function(t){if(this.loadingStatus)return!1;document.getElementById("file").click()},tirggerFile:function(t){if(this.loadingStatus)return!1;this.moreUploadImg(t,3)},studyfileClick:function(t){if(this.studyloadingStatus)return!1;document.getElementById("studyfile").click()},studyTirggerFile:function(t){if(this.studyloadingStatus)return!1;this.moreUploadImg(t,4)},DeletePic:function(t){var e=this;return c()(n.a.mark(function a(){return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,u.a.deletePic({obj:t.photoUrl});case 2:200===a.sent.code&&(1===t.familyStatus?(e.familyPicMore.splice(t.index,1),e.morePic.splice(t.index,1),e.familyPicMore.length<=2&&(e.familyLength=[])):2===t.familyStatus&&(e.stydyPicMore.splice(t.index,1),e.studyPic.splice(t.index,1),(e.stydyPicMore.length<=2||""===e.stydyPicMore)&&(e.studyLength=[])));case 4:case"end":return a.stop()}},a,e)}))()}}}),y={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"RecipientsInfo"},[a("gradeName",{attrs:{selectGrade:t.selectGrade},on:{cancelSelect:t.cancelSelect,confirmSelect:t.confirmSelect}}),t._v(" "),a("section",{staticClass:"top_info",style:{paddingBottom:void 0===this.recipientsId?0:"2rem"}},[a("aside",[a("div",{staticClass:"photo"},[a("span",[t._v("头像")]),t._v(" "),a("div",[a("van-uploader",{attrs:{name:"uploader","after-read":t.photoOnRead}},[t.photoStatus?a("div",{staticClass:"img"},[""!=t.item.photo?a("img",{style:{backgroundImage:"url("+t.item.photo+")"},attrs:{alt:""}}):a("van-loading",{attrs:{type:"spinner",color:"#1989fa"}})],1):a("i",[a("span",[t._v("上传头像")])])])],1)]),t._v(" "),a("div",[a("van-field",{attrs:{label:"姓名",placeholder:"请输入受助人姓名"},model:{value:t.item.name,callback:function(e){t.$set(t.item,"name",e)},expression:"item.name"}})],1),t._v(" "),a("div",[a("van-field",{attrs:{label:"身份证",placeholder:"请输入受助人身份证号码",pattern:"^([0-9]){7,18}(x|X)?$"},on:{blur:t.idCardVerification},model:{value:t.item.cardId,callback:function(e){t.$set(t.item,"cardId",e)},expression:"item.cardId"}})],1),t._v(" "),a("div",[a("van-field",{attrs:{label:"年龄",placeholder:"请输年龄",pattern:"[0-9]*",readonly:""},model:{value:t.item.age,callback:function(e){t.$set(t.item,"age",e)},expression:"item.age"}})],1),t._v(" "),a("div",{staticClass:"grade"},[a("span",[t._v("性别")]),t._v(" "),a("span",{class:"根据身份证识性别"==t.item.sexName?"in":"on"},[t._v(t._s(t.item.sexName))])]),t._v(" "),a("div",{staticClass:"grade",on:{click:t.selectG}},[a("span",[t._v("加入年级")]),t._v(" "),""==t.item.classNumber?a("van-icon",{attrs:{name:"arrow-down"}}):a("span",{staticClass:"on"},[t._v(t._s(t.item.classNumber)+"年级")])],1),t._v(" "),a("div",{staticClass:"grade",on:{click:t.selectAddress}},[a("span",[t._v("选择地址")]),t._v(" "),a("span",{class:"请选择地址"===t.item.region?"in":"on"},[t._v(t._s(t.item.region))])]),t._v(" "),a("div",[a("van-field",{attrs:{label:"详细地址",placeholder:"请输入详细地址"},model:{value:t.item.address,callback:function(e){t.$set(t.item,"address",e)},expression:"item.address"}})],1)]),t._v(" "),a("aside",{staticClass:"IdCard",staticStyle:{margin:"0","border-bottom":"10px solid #f7f7f7"}},[a("p",{staticStyle:{padding:"0.45rem","font-size":"0.4rem"}},[t._v("上存受助人身份证照片或者户口本照片")]),t._v(" "),a("div",[a("div",[a("div",[a("van-uploader",{attrs:{name:"uploader","after-read":t.onRead}},[t.positivePicState?a("div",[""!=t.positivePic?a("img",{style:{backgroundImage:"url("+t.positivePic+")"},attrs:{alt:""}}):a("van-loading",{attrs:{type:"spinner",color:"#1989fa"}})],1):a("van-icon",{attrs:{name:"photograph"}})],1)],1),t._v(" "),a("p",[t._v("身份证正面或者户口本首页")])]),t._v(" "),a("div",[a("div",[a("van-uploader",{attrs:{name:"uploader","after-read":t.Read}},[t.againstPicState?a("div",[""!=t.againstPic?a("img",{style:{backgroundImage:"url("+t.againstPic+")"},attrs:{alt:""}}):a("van-loading",{attrs:{type:"spinner",color:"#1989fa"}})],1):a("van-icon",{attrs:{name:"photograph"}})],1)],1),t._v(" "),a("p",[t._v("身份证反面或户口本本人页")])])])]),t._v(" "),a("aside",[a("div",[a("div",{staticClass:"infoTop",staticStyle:{"border-bottom":"5px solid #f9f9f9"}},[a("div",{staticClass:"textarea"},[a("van-field",{attrs:{label:"家庭情况",type:"textarea",placeholder:t.familyPlaceholder,rows:"1",autosize:""},on:{focus:t.familySituation,blur:t.familyBlur},model:{value:t.item.family,callback:function(e){t.$set(t.item,"family",e)},expression:"item.family"}}),t._v(" "),a("span",[t._v("（200字/500字）")])],1),t._v(" "),a("div",{attrs:{id:"morePic"}},[a("div",{staticClass:"Pic"},[t._l(t.familyPicMore,function(e,i){return a("div",{key:i},[a("van-icon",{attrs:{name:"cross"},on:{click:function(a){return t.deletePic({index:i,photoUrl:e,familyStatus:1})}}}),t._v(" "),a("span",{staticClass:"img",style:{backgroundImage:"url("+e+")",backgroundSize:"cover"},on:{click:function(a){return t.seeBigTu(e,t.familyPicMore)}}})],1)}),t._v(" "),t.loadingStatus?[a("div",[a("div",{staticClass:"loading"},[a("van-loading",{attrs:{type:"spinner",color:"#1989fa"}})],1)])]:t._e()],2),t._v(" "),3!==t.familyPicMore.length&&3!==t.familyLength.length?a("div",{staticClass:"van-uploader"},[a("div",{staticClass:"upload_warp_left",on:{click:t.fileClick}},[a("button",{staticClass:"btn btn-success"})]),t._v(" "),a("input",{attrs:{type:"file",multiple:"",id:"file",accept:"image/*"},on:{change:t.tirggerFile}}),t._v(" "),a("div",[a("van-icon",{attrs:{name:"photograph"}})],1)]):t._e()]),t._v(" "),a("p",{staticClass:"third"},[t._v("照片上传只限三张，请谨慎选择！")])]),t._v(" "),a("div",{staticClass:"infoTop"},[a("div",{staticClass:"textarea"},[a("van-field",{attrs:{label:"学习情况",type:"textarea",placeholder:t.studyPlaceholder,rows:"1",autosize:""},on:{focus:t.studySituation,blur:t.studyBlur},model:{value:t.item.learn,callback:function(e){t.$set(t.item,"learn",e)},expression:"item.learn"}}),t._v(" "),a("span",[t._v("（200字/500字）")])],1),t._v(" "),a("div",{attrs:{id:"morePic"}},[a("div",{staticClass:"Pic"},[t._l(t.stydyPicMore,function(e,i){return a("div",{key:i},[a("van-icon",{attrs:{name:"cross"},on:{click:function(a){return t.deletePic({index:i,photoUrl:e,familyStatus:2})}}}),t._v(" "),a("span",{staticClass:"img",style:{backgroundImage:"url("+e+")",backgroundSize:"cover"},on:{click:function(a){return t.seeBigTu(e,t.stydyPicMore)}}})],1)}),t._v(" "),t.studyloadingStatus?[a("div",[a("div",{staticClass:"loading"},[a("van-loading",{attrs:{type:"spinner",color:"#1989fa"}})],1)])]:t._e()],2),t._v(" "),3!==t.stydyPicMore.length&&3!==t.studyLength.length?a("div",{staticClass:"van-uploader"},[a("div",{staticClass:"upload_warp_left",on:{click:t.studyfileClick}},[a("button",{staticClass:"btn btn-success"})]),t._v(" "),a("input",{attrs:{type:"file",multiple:"",id:"studyfile",accept:"image/*"},on:{change:t.studyTirggerFile}}),t._v(" "),a("div",[a("van-icon",{attrs:{name:"photograph"}})],1)]):t._e()]),t._v(" "),a("p",{staticClass:"third"},[t._v("照片上传只限三张，请谨慎选择！")])])])])]),t._v(" "),void 0===t.recipientsId?a("footer",[a("button",{directives:[{name:"intervalclick",rawName:"v-intervalclick",value:{func:t.dataClick,time:2e3},expression:"{func:dataClick,time:2000,}"}],staticClass:"sumbit_btn"},[t._v("提交")])]):a("footer",{staticClass:"updata"},[a("button",{on:{click:t.deleteList}},[t._v("删除受助人")]),t._v(" "),a("button",{directives:[{name:"intervalclick",rawName:"v-intervalclick",value:{func:t.updataClick,time:2e3},expression:"{func:updataClick,time:2000,}"}],staticClass:"sumbit_btn"},[t._v("提交")])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.areaStatus,expression:"areaStatus"}],staticClass:"area"},[a("van-area",{attrs:{"area-list":t.areaList},on:{confirm:t.confirm,cancel:t.cancel}})],1)],1)},staticRenderFns:[]};var _=a("C7Lr")(h,y,!1,function(t){a("T2ZH"),a("6Ggo")},"data-v-8843ea1e",null);e.default=_.exports}});