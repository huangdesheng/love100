webpackJsonp([10],{"1/gI":function(e,t){},"57pv":function(e,t){},BaUS:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("lC5x"),r=a.n(n),i=a("J0Oq"),s=a.n(i),o=a("aA9S"),l=a.n(o),c=a("gyMJ"),v={data:function(){return{show:!1,selectFareStatus:!1,timer:null,money:"自定义金额",list:[1,2,3,4],loveVlaue:0,active:"",price:""}},props:["projectId"],methods:{transword:function(){this.money="自定义金额",this.price="",this.$emit("showValue",this.show)},submit_pay:function(){clearInterval(this.timer),this.timer=null,0===this.money||"自定义金额"===this.money?this.$dialog({message:"请输入公益金额"}):this.WxPay()},oninput:function(e){if(this.price=e.target.value,e.target.value=e.target.value.match(/^\d*(\.?\d{0,2})/g)[0]||this.price,""===e.target.value)this.price=this.price;else{var t=e.target.value.replace(/^(\-)*(\d+)\.(\d\d).*$/,"$1$2.$3");this.price=t}this.money=this.price},WxPay:function(){var e=this;return s()(r.a.mark(function t(){var a,n;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.a.welfarPay({amount:e.money,projectId:e.projectId});case 2:a=t.sent,n=l()({},a.data,{package:a.data.packageValue}),200===a.code?e.wxpay(n):e.$dialog({message:a.message});case 5:case"end":return t.stop()}},t,e)}))()},wxpay:function(e){var t=this;return s()(r.a.mark(function a(){var n;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:n=t,WeixinJSBridge.invoke("getBrandWCPayRequest",e,function(e){"get_brand_wcpay_request:ok"==e.err_msg?n.$router.replace({path:"/loveWelfare/welfare_reply",query:{projectId:n.projectId}}):"get_brand_wcpay_request:cancel"==e.err_msg||n.$dialog({message:"支付失败"})});case 2:case"end":return a.stop()}},a,t)}))()},selectFare:function(){var e=this;if(this.selectFareStatus=!this.selectFareStatus,this.active="",this.selectFareStatus){var t=this;t.setTimer(),setTimeout(function(){clearInterval(e.timer),t.timer=null,t.selectFareStatus=!1},500)}},money_btn:function(e){this.money=10*e,this.active=e-1,this.price=""},changePrice:function(){this.active="",this.price="",this.money=0},InputMoney:function(e){console.log(e)},setTimer:function(){var e=this;this.timer=setInterval(function(){var t=["1.11","6.66","8.88","9.99","18.88","38.88"],a=Math.floor(Math.random()*t.length);e.price=t[a],e.money=e.price},50)}},watch:{price:function(e){}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_fare",on:{touchmove:function(e){e.preventDefault()}}},[a("div",[a("p",[a("van-icon",{attrs:{name:"cross"},on:{click:function(t){return t.preventDefault(),e.transword(t)}}})],1),e._v(" "),a("div",[a("img",{attrs:{src:"http://love100.qxiao.net:8888/group1/M00/00/03/rBFAEl0S5j-AH__4AANOv5xJKC0676.png",alt:""}}),e._v(" "),a("div",[a("h2",[e._v("给山里孩子的绘本书")]),e._v(" "),""!=e.money?a("p",[e._v(e._s(parseInt("自定义金额"===e.money?0:e.money))+"份爱心")]):a("p",[e._v("0份爱心")]),e._v(" "),a("p",[a("span",[e._v("￥")]),e._v(" "),""!=e.money?a("span",[e._v(e._s("自定义金额"===e.money?0:parseFloat(e.money).toFixed(2)))]):a("span",[e._v("0")])])])]),e._v(" "),a("div",e._l(e.list,function(t,n){return a("span",{key:n,class:n===e.active?"on":"",on:{click:function(a){return a.preventDefault(),e.money_btn(t)}}},[e._v(e._s(t)+"0份爱心")])}),0),e._v(" "),a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.price,expression:"price"}],attrs:{type:"number",placeholder:"自定义金额"},domProps:{value:e.price},on:{focus:e.changePrice,input:[function(t){t.target.composing||(e.price=t.target.value)},e.oninput]}}),e._v(" "),a("div",[a("van-icon",{attrs:{name:"replay"}}),e._v(" "),a("span",{on:{click:function(t){return t.preventDefault(),e.selectFare(t)}}},[e._v("随机")])],1)]),e._v(" "),a("button",{on:{click:function(t){return t.preventDefault(),e.submit_pay(t)}}},[e._v("确定")])])])},staticRenderFns:[]};var p={data:function(){return{show:!1,welfarDetail:{},rate:0,welfareList:[],openStatus:!1,status:!0,controlPic:""}},components:{pageFare:a("C7Lr")(v,u,!1,function(e){a("1/gI")},"data-v-374d741b",null).exports},mixins:[a("cnSu").a],mounted:function(){window.scroll(0,0),this.welfarDetails(this.$route.query.projectId)},methods:{welfarDetails:function(e){var t=this;return s()(r.a.mark(function a(){var n,i;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,c.a.welfarDetails({projectId:e});case 2:200===(n=a.sent).code?(t.welfarDetail=n.data,t.status=t.welfarDetail.welfareList.length>2,i=t.welfarDetail.welfareList.filter(function(e,t){return t<2}),t.welfareList=i,t.controlPic=n.data.imageUrls[0],t.rate=parseInt(n.data.currentAmount/n.data.targetAmount*100)):t.$dialog(n.message);case 4:case"end":return a.stop()}},a,t)}))()},fareShow:function(){this.show=!this.show},showChildMsg:function(e){this.show=e},openwelfare:function(){this.openStatus=!0,this.welfareList=this.welfarDetail.welfareList},closewelfare:function(){this.openStatus=!1,this.welfareList=this.welfarDetail.welfareList.filter(function(e,t){return t<2})}}},_={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-welfare page-index"},[a("header",[a("div",{staticClass:"banner"},[a("van-swipe",{attrs:{autoplay:3e3,"indicator-color":"white"}},e._l(e.welfarDetail.imageUrls,function(t,n){return a("van-swipe-item",{key:n},[a("img",{attrs:{src:t,alt:"",width:"100%"},on:{click:function(a){return e.seeBigTu(t,e.welfarDetail.imageUrls)}}})])}),1),e._v(" "),0===e.welfarDetail.status?a("button",[e._v("筹款中")]):e._e(),e._v(" "),1===e.welfarDetail.status?a("button",[e._v("筹款结束")]):e._e(),e._v(" "),a("div",[a("div",[a("p",[e._v(e._s(e.welfarDetail.title))]),e._v(" "),a("p",[e._v(e._s(e.welfarDetail.introduce))]),e._v(" "),a("van-progress",{attrs:{percentage:e.rate,"pivot-color":"#aaa",color:"red"}}),e._v(" "),a("van-row",[a("van-col",{attrs:{span:"6"}},[a("p",[e._v("目标筹款/元")]),e._v(" "),a("p",[e._v(e._s(e.welfarDetail.targetAmount))])]),e._v(" "),a("van-col",{attrs:{span:"12"}},[a("p",[e._v("当前筹款/元")]),e._v(" "),a("p",[e._v(e._s(e.welfarDetail.currentAmount))])]),e._v(" "),a("van-col",{attrs:{span:"6"}},[a("p",[e._v("捐款人次/次")]),e._v(" "),a("p",[e._v(e._s(e.welfarDetail.donateNumber))])])],1)],1)])],1),e._v(" "),a("div",{staticClass:"welfare_content"},[a("div",[a("div",[a("h2",[e._v("项目介绍")]),e._v(" "),a("p",[e._v(e._s(e.welfarDetail.introduce))]),e._v(" "),a("img",{attrs:{src:e.controlPic,alt:"",width:"100%"},on:{click:function(t){return e.singleBigTu(e.controlPic)}}})]),e._v(" "),a("div",[a("h2",[e._v("项目预算")]),e._v(" "),a("div",[a("h3",[e._v("1、项目费用")]),e._v(" "),a("p",[e._v(e._s(e.welfarDetail.projectBudget))]),e._v(" "),a("img",{attrs:{src:e.welfarDetail.budgetPhoto,alt:"",width:"100%"},on:{click:function(t){return e.singleBigTu(e.welfarDetail.budgetPhoto)}}})]),e._v(" "),a("div",[a("h3",[e._v("2、管理费说明")]),e._v(" "),a("p",[e._v(e._s(e.welfarDetail.explain))])]),e._v(" "),a("div",[a("h3",[e._v("3、执行计划")]),e._v(" "),a("p",[e._v(e._s(e.welfarDetail.implementation))])])])])]),e._v(" "),e._m(0),e._v(" "),a("div",{staticClass:"loveList",style:{paddingBottom:0==e.welfarDetail.status?"2rem":"0.3rem"}},[a("div",[a("h2",[e._v("公益记录")]),e._v(" "),e.welfareList.length>0?a("ul",e._l(e.welfareList,function(t,n){return a("li",{key:n},[a("div",[a("img",{attrs:{src:t.photo,alt:"",width:"100%"}}),e._v(" "),a("span",[e._v(e._s(t.username))])]),e._v(" "),a("p",[e._v("\n              捐出\n              "),a("span",[e._v(e._s(t.amount))]),e._v("元\n            ")]),e._v(" "),"刚刚"==t.timeDifference?a("p",[e._v(e._s(t.timeDifference))]):a("p",[e._v(e._s(t.timeDifference)+"前")])])}),0):a("div",{staticClass:"no_data_welfare"},[e._v("暂无公益记录")]),e._v(" "),e.status?[e.openStatus?a("p",{on:{click:e.closewelfare}},[a("van-icon",{attrs:{name:"arrow-up"},on:{click:e.closewelfare}}),e._v("收起查看更多爱心贡献\n          ")],1):a("p",{on:{click:e.openwelfare}},[a("van-icon",{attrs:{name:"arrow-down"},on:{click:e.openwelfare}}),e._v("展开查看更多爱心贡献\n          ")],1)]:e._e()],2)])]),e._v(" "),a("pageFare",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],attrs:{projectId:e.welfarDetail.projectId},on:{showValue:e.showChildMsg}}),e._v(" "),0===e.welfarDetail.status?a("div",{staticClass:"footer"},[a("van-button",{attrs:{type:"primary"},on:{click:e.fareShow}},[e._v("我要捐款")])],1):e._e()],1)},staticRenderFns:[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"info"},[a("div",[a("h2",[e._v("慈善机构信息")]),e._v(" "),a("p",[a("span",[e._v("慈善机构：")]),e._v(" "),a("span",[e._v("广州市华侨文化发展基金会")])]),e._v(" "),a("p",[a("span",[e._v("机构负责人：")]),e._v(" "),a("span",[e._v("吴远斌")])]),e._v(" "),a("p",[a("span",[e._v("善款接收：")]),e._v(" "),a("span",[e._v("广州市华侨文化发展基金会")])])])])}]};var f=a("C7Lr")(p,_,!1,function(e){a("57pv"),a("KWkD")},"data-v-95434552",null);t.default=f.exports},KWkD:function(e,t){}});