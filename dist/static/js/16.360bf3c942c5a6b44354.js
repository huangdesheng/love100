webpackJsonp([16],{DWtU:function(t,e){},SVqm:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("lC5x"),i=n.n(a),o=n("aA9S"),s=n.n(o),r=n("J0Oq"),c=n.n(r),l=n("p6jS"),u=n("gyMJ"),d={data:function(){return{bankHolder:"开户账号信息与受助人保持一致"}},methods:{bankCodeVerifications:function(){""!=this.info.bankAccount&&""!=this.info.bankTele&&this.binName()},binName:function(){var t=this;return c()(i.a.mark(function e(){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.binName({bankAccount:t.info.bankAccount,bankTele:t.info.bankTele,cardId:"511126199112064713",name:"施京"});case 2:200===(n=e.sent).code?"没有找到该卡的银行"===n.data.msg?t.bankHolder="开户账号信息与受助人保持一致":t.info.bankName=n.data.binName:t.$dialog({message:n.message});case 4:case"end":return e.stop()}},e,t)}))()},focusBank:function(){this.bankHolder=""}}},f=n("w3CS"),v={data:function(){return{item:{urls:[],bankAccount:"6217003810083356892",bankName:"",bankTele:"18502821864",type:"",verification:"",tele:"13411062173"},ticketPic:"",admissionPic:"",info:{},show:!0,count:"",timer:null,bankHolder:"开户账号信息与受助人保持一致"}},mixins:[l.a,d],mounted:function(){var t=this.$route.query.applyId,e=this.$route.query.type,n=this.$route.query.state;-1==n?this.ApplicationMutalQuery(t,e):2==n&&(this.ticketPicState=!0,this.admissionPicState=!0,this.AuditInformationUpdate(t,e))},methods:{ApplicationMutalQuery:function(t,e){var n=this;return c()(i.a.mark(function e(){var a,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.ApplicationMutalQuery(t);case 2:200===(a=e.sent).code&&(o=s()({},n.item,a.data),n.info=o);case 4:case"end":return e.stop()}},e,n)}))()},AuditInformationUpdate:function(t,e){var n=this;return c()(i.a.mark(function e(){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.AuditInformationUpdate(t);case 2:200===(a=e.sent).code&&(n.info=a.data,n.ticketPic=a.data.urls[0],n.admissionPic=a.data.urls[1]);case 4:case"end":return e.stop()}},e,n)}))()},getCode:function(){var t=this;if(!Object(f.b)(this.info.bankTele))return this.$dialog.alert({message:"输入正确的手机号"}),!1;this.show&&this.getcode(),this.show=!1;this.timer||(this.count=60,this.show=!1,this.timer=setInterval(function(){t.count>0&&t.count<=60?t.count--:(t.show=!0,clearInterval(t.timer),t.timer=null)},1e3))},getcode:function(){var t=this;return c()(i.a.mark(function e(){var n,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.info.bankTele,e.next=3,u.a.getCode({tele:n,type:2});case 3:200===(a=e.sent).code||(t.$dialog({message:a.message,confirmButtonColor:"#40D0B3",confirmButtonText:"确定"}),t.show=!0,clearInterval(t.timer),t.timer=null);case 5:case"end":return e.stop()}},e,t)}))()},apply_btn:function(){""!=this.ticketPic&&""!=this.admissionPic?this.info.urls=[this.ticketPic,this.admissionPic]:this.$dialog.alert({message:"您还未上传证明材料照片",confirmButtonColor:"#40d0b3"}),this.info.type=this.$route.query.type,this.info.recipientsIds=this.$route.query.recipientsId;var t=this.info;this.submitApply(t)},submitApply:function(t){var e=this;return c()(i.a.mark(function n(){var a;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,u.a.submitApply(t);case 2:a=n.sent,console.log(a),200===a.code?e.$dialog.alert({message:"申请资料提交成功 等待资料审核。",confirmButtonColor:"#40d0b3"}).then(function(){e.$router.replace({path:"/personalCenter/applyReward"})}):e.$dialog.alert({message:a.message,confirmButtonColor:"#40d0b3"});case 5:case"end":return n.stop()}},n,e)}))()}}},p={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[2==t.info.state?n("aside",{staticClass:"tip"},[t._v(t._s(t.info.auditDescribe))]):t._e(),t._v(" "),n("header",[n("div",[n("p",[t._v("受助人："+t._s(t.info.name))]),t._v(" "),n("p",[t._v("身份证："+t._s(t.info.cardId))]),t._v(" "),n("p",[t._v("受助类型:"+t._s(t.info.title))])])]),t._v(" "),n("section",[n("aside",{staticClass:"IdCard"},[n("h2",[t._v("证明材料")]),t._v(" "),n("p",{staticStyle:{padding:"0.45rem",color:"#999","font-size":"0.38rem"}},[t._v("请上传受助人准考证和录取通知书照片。")]),t._v(" "),n("div",[n("div",[n("div",[n("van-uploader",{attrs:{name:"uploader","after-read":t.onReadTicketPic}},[t.ticketPicState?n("div",[""!=t.ticketPic?n("img",{style:{backgroundImage:"url("+t.ticketPic+")"},attrs:{alt:""}}):n("van-loading",{attrs:{type:"spinner",color:"#1989fa"}})],1):n("van-icon",{attrs:{name:"photograph"}})],1)],1),t._v(" "),n("p",[t._v("受助人准考证")])]),t._v(" "),n("div",[n("div",[n("van-uploader",{attrs:{name:"uploader","after-read":t.onReadAmission}},[t.admissionPicState?n("div",[""!=t.admissionPic?n("img",{style:{backgroundImage:"url("+t.admissionPic+")"},attrs:{alt:""}}):n("van-loading",{attrs:{type:"spinner",color:"#1989fa"}})],1):n("van-icon",{attrs:{name:"photograph"}})],1)],1),t._v(" "),n("p",[t._v("受助人录取通知书")])])])]),t._v(" "),n("div",{staticClass:"infoBot"},[n("div",[n("van-field",{attrs:{label:"受助人收款账号：",placeholder:t.bankHolder},on:{focus:t.focusBank,blur:t.bankCodeVerifications},model:{value:t.info.bankAccount,callback:function(e){t.$set(t.info,"bankAccount",e)},expression:"info.bankAccount"}})],1),t._v(" "),n("div",[n("van-field",{attrs:{label:"银行预留手机号：",placeholder:"请输入手机号",pattern:"[0-11]*"},on:{blur:t.bankCodeVerifications},model:{value:t.info.bankTele,callback:function(e){t.$set(t.info,"bankTele",e)},expression:"info.bankTele"}})],1),t._v(" "),n("van-field",{attrs:{center:"",placeholder:"请输入短信验证码",id:"sms"},model:{value:t.info.verification,callback:function(e){t.$set(t.info,"verification",e)},expression:"info.verification"}},[n("van-button",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],attrs:{slot:"button",size:"small",type:"primary"},on:{click:t.getCode},slot:"button"},[t._v("获取验证码")]),t._v(" "),n("van-button",{directives:[{name:"show",rawName:"v-show",value:!t.show,expression:"!show"}],attrs:{slot:"button",size:"small",type:"primary"},slot:"button"},[t._v(t._s(t.count)+" s")])],1),t._v(" "),n("div",[n("van-field",{attrs:{label:"开户行名称：",placeholder:""},model:{value:t.info.bankName,callback:function(e){t.$set(t.info,"bankName",e)},expression:"info.bankName"}})],1),t._v(" "),n("van-cell-group",{staticClass:"helperNumber"},[n("van-field",{attrs:{label:"受助人手机号码：",placeholder:"请输入用户名",pattern:"[0-11]*"},model:{value:t.info.tele,callback:function(e){t.$set(t.info,"tele",e)},expression:"info.tele"}})],1)],1)]),t._v(" "),n("footer",[n("div",{on:{click:t.apply_btn}},[t._v("立即申请")])])])},staticRenderFns:[]};var m=n("C7Lr")(v,p,!1,function(t){n("aHYZ"),n("DWtU")},"data-v-c88df304",null);e.default=m.exports},aHYZ:function(t,e){}});